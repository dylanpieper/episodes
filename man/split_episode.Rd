% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/episodes.R
\name{split_episode}
\alias{split_episode}
\title{Split episodes to analyze continuation across time thresholds}
\usage{
split_episode(.data, thresholds, units = NULL, max_date = NULL)
}
\arguments{
\item{.data}{A data frame output from \code{segment_episodes()} containing at minimum
the columns \code{episode_start} and \code{episode_end}.}

\item{thresholds}{Numeric vector of time thresholds to analyze.}

\item{units}{Character vector of time units corresponding to each threshold,
or a single unit to apply to all thresholds. One of "days", "weeks", or "months".
Defaults to "days" for all thresholds if NULL.}

\item{max_date}{Optional reference date to use for eligibility calculations.
Defaults to the current system date.}
}
\value{
The input data frame with additional columns for each threshold:
\itemize{
\item \strong{threshold_unit_date}: The date corresponding to threshold unit after episode_start
\item \strong{threshold_unit_eligible}: Logical indicating if enough time has passed to evaluate this threshold
\item \strong{threshold_unit_continued}: Logical indicating if the episode continued past this threshold
}
}
\description{
\code{split_episode()} splits the output from \code{segment_episodes()} to analyze
whether episodes continue past specific time thresholds.
}
\examples{
data(substance_use)
# First, segment the data into episodes
treatment_episodes <- substance_use |>
  group_by(client_id) |>
  segment_episodes(
    visit_date,
    gap_threshold = 2,
    gap_unit = "months"
  )

# Then analyze whether episodes continue past specific thresholds
episode_retention <- treatment_episodes |>
  split_episode(thresholds = c(30, 60, 90, 180), units = "days")
  
# Analyze retention rates at different thresholds
retention_summary <- episode_retention |>
  summarize(
    episodes_count = n(),
    continued_30d = sum(days_30_continued, na.rm = TRUE),
    continued_60d = sum(days_60_continued, na.rm = TRUE),
    continued_90d = sum(days_90_continued, na.rm = TRUE),
    continued_180d = sum(days_180_continued, na.rm = TRUE),
    pct_30d = mean(days_30_continued, na.rm = TRUE) * 100,
    pct_60d = mean(days_60_continued, na.rm = TRUE) * 100,
    pct_90d = mean(days_90_continued, na.rm = TRUE) * 100,
    pct_180d = mean(days_180_continued, na.rm = TRUE) * 100
  )
  
# You can also use different time units
monthly_retention <- treatment_episodes |>
  split_episode(
    thresholds = c(1, 3, 6, 12),
    units = "months"
  )

}
\seealso{
\code{\link{segment_episodes}} for creating episode segments
}
