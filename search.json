[{"path":"https://dylanpieper.github.io/episodes/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2025 episodes authors Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://dylanpieper.github.io/episodes/articles/survival.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"Survival Analysis with episodes and tidymodels","text":"{episodes} package segments longitudinal data meaningful episodes based temporal gaps variable changes. ’s designed analyzing treatment patterns, patient journeys, time series data interruptions changes covariates important model. vignette demonstrates apply features survival analysis using {tidymodels} run Cox proportional hazards models fixed time-varying covariates. using simulated substance_use dataset included package.","code":""},{"path":"https://dylanpieper.github.io/episodes/articles/survival.html","id":"required-packages","dir":"Articles","previous_headings":"","what":"Required Packages","title":"Survival Analysis with episodes and tidymodels","text":"","code":"library(episodes) library(tidymodels) library(censored) library(survival) library(ggsurvfit) library(dplyr)  surv_spec <- proportional_hazards() |>   set_engine(\"survival\")"},{"path":[]},{"path":"https://dylanpieper.github.io/episodes/articles/survival.html","id":"creating-episodes-with-fixed-covariates","dir":"Articles","previous_headings":"Time to Discontinuation Analysis","what":"Creating Episodes with Fixed Covariates","title":"Survival Analysis with episodes and tidymodels","text":"first example examines time treatment discontinuation, using fixed-effects approach covariates considered constant throughout episode.","code":"episodes_fixed <- substance_use |>   group_by(client_id) |>   segment_episodes(     date_col = visit_date,     gap_threshold = 60,     gap_unit = \"days\",     progress = FALSE   )  model_result <- workflow() |>   add_formula(     Surv(episode_days, discontinued) ~       age + gender + race + substance + medication + mental_health_disorder +       died_ever + cluster(client_id)   ) |>   add_model(surv_spec) |>   fit(data = episodes_fixed) |>   extract_fit_parsnip() |>   tidy(exponentiate = TRUE, conf.int = TRUE, conf.level = 0.95)  model_result #> # A tibble: 17 × 7 #>    term                estimate std.error statistic   p.value conf.low conf.high #>    <chr>                  <dbl>     <dbl>     <dbl>     <dbl>    <dbl>     <dbl> #>  1 age                    1.00    8.44e-4    0.708   4.79e- 1    0.999     1.00  #>  2 mental_health_diso…    0.689   2.41e-2  -15.5     5.24e-54    0.657     0.722 #>  3 mental_health_diso…   NA       0         NA      NA          NA        NA     #>  4 died_everTRUE          1.40    2.69e-2   12.4     1.94e-35    1.32      1.47  #>  5 `cluster(client_id…    1.00    7.96e-6    0.598   5.50e- 1    1.00      1.00  #>  6 genderFemale           1.02    2.33e-2    0.833   4.05e- 1    0.974     1.07  #>  7 genderNon-binary       1.11    6.01e-2    1.67    9.50e- 2    0.983     1.24  #>  8 raceBlack              1.02    3.28e-2    0.483   6.29e- 1    0.953     1.08  #>  9 raceHispanic           0.974   3.28e-2   -0.797   4.25e- 1    0.914     1.04  #> 10 raceAsian              0.920   5.32e-2   -1.57    1.17e- 1    0.829     1.02  #> 11 raceOther              1.06    5.47e-2    1.00    3.17e- 1    0.949     1.18  #> 12 substanceOpiates       1.15    4.24e-2    3.39    7.03e- 4    1.06      1.25  #> 13 medicationDisulfir…    0.940   4.25e-2   -1.45    1.46e- 1    0.865     1.02  #> 14 medicationAcampros…    0.988   3.87e-2   -0.309   7.57e- 1    0.916     1.07  #> 15 medicationNaltrexo…    0.973   3.69e-2   -0.741   4.59e- 1    0.905     1.05  #> 16 medicationMethadone    1.01    5.95e-2    0.153   8.78e- 1    0.898     1.13  #> 17 medicationBuprenor…    0.996   5.62e-2   -0.0735  9.41e- 1    0.892     1.11"},{"path":"https://dylanpieper.github.io/episodes/articles/survival.html","id":"interpreting-the-results","dir":"Articles","previous_headings":"Time to Discontinuation Analysis > Creating Episodes with Fixed Covariates","what":"Interpreting the Results","title":"Survival Analysis with episodes and tidymodels","text":"model results show hazard ratios (HR) variable, : - HR < 1: Reduced risk discontinuation (better retention) - HR > 1: Increased risk discontinuation (worse retention) - HR = 1: effect discontinuation risk Key findings: Mental health disorder: Clients mental health disorders significantly better retention (HR = 0.689, 95% CI: 0.657-0.722), indicating 31.1% reduction discontinuation risk. Mortality: Clients died 40% higher risk treatment discontinuation (HR = 1.40, 95% CI: 1.32-1.47). Substance type: Opiate users 15% higher risk discontinuation compared alcohol users (HR = 1.15, 95% CI: 1.06-1.25). Demographics: Age, gender, race show minimal effects treatment retention model. Medications: None medications show statistically significant effects retention, though point estimates suggest small protective effects treatments.","code":""},{"path":"https://dylanpieper.github.io/episodes/articles/survival.html","id":"visualizing-survival-by-mental-health-disorder-status","dir":"Articles","previous_headings":"Time to Discontinuation Analysis","what":"Visualizing Survival by Mental Health Disorder Status","title":"Survival Analysis with episodes and tidymodels","text":"can visualize differences Kaplan-Meier curves:  Kaplan-Meier plot confirms model findings - clients mental health disorders (blue line) substantially better retention time compared without (red line). 500 days, approximately 40% clients mental health disorders remain treatment, compared 20% without. non-overlapping confidence intervals indicate difference statistically significant throughout observation period.","code":"surv_curves <- survfit(   Surv(episode_days, discontinued) ~ mental_health_disorder,   data = episodes_fixed )  ggsurvfit(surv_curves) +   add_confidence_interval() +   add_risktable() +   scale_y_continuous(labels = scales::percent) +   labs(     x = \"Days\",     y = \"Probability of Retention\",     title = \"Kaplan-Meier Curves by Mental Health Disorder Status\"   )"},{"path":"https://dylanpieper.github.io/episodes/articles/survival.html","id":"time-varying-covariates-model","dir":"Articles","previous_headings":"Time to Discontinuation Analysis","what":"Time-Varying Covariates Model","title":"Survival Analysis with episodes and tidymodels","text":"segment_episodes_by_covars function creates dataset observations split whenever specified covariate changes value. allows us incorporate time-varying covariates survival analysis.","code":"episodes_tv <- substance_use |>   group_by(client_id) |>   segment_episodes_by_covars(     date_col = visit_date,     covar_cols = c(       \"frequency_of_use\", \"housing\"     ),     gap_threshold = 60,     gap_unit = \"days\",     progress = FALSE   ) |>   group_by(client_id, episode_id) |>   add_surv_time()  tv_model_result <- workflow() |>   add_formula(     Surv(time = start_time, time2 = end_time, event = discontinued) ~       age + gender + race + substance + medication + mental_health_disorder +       frequency_of_use + housing + died_ever + cluster(client_id)   ) |>   add_model(surv_spec) |>   fit(data = episodes_tv) |>   extract_fit_parsnip() |>   tidy(exponentiate = TRUE, conf.int = TRUE, conf.level = 0.95)  tv_model_result #> # A tibble: 24 × 7 #>    term                estimate std.error statistic   p.value conf.low conf.high #>    <chr>                  <dbl>     <dbl>     <dbl>     <dbl>    <dbl>     <dbl> #>  1 age                    1.00    8.45e-4     0.846  3.98e- 1    0.999     1.00  #>  2 mental_health_diso…    0.678   2.41e-2   -16.1    1.90e-58    0.647     0.711 #>  3 mental_health_diso…   NA       0          NA     NA          NA        NA     #>  4 died_everTRUE          1.21    2.84e-2     6.73   1.67e-11    1.14      1.28  #>  5 `cluster(client_id…    1.00    7.96e-6     0.367  7.13e- 1    1.00      1.00  #>  6 genderFemale           1.02    2.34e-2     1.00   3.17e- 1    0.978     1.07  #>  7 genderNon-binary       1.10    6.02e-2     1.52   1.29e- 1    0.974     1.23  #>  8 raceBlack              1.02    3.28e-2     0.734  4.63e- 1    0.961     1.09  #>  9 raceHispanic           0.991   3.28e-2    -0.289  7.72e- 1    0.929     1.06  #> 10 raceAsian              0.922   5.32e-2    -1.53   1.27e- 1    0.831     1.02  #> # ℹ 14 more rows"},{"path":"https://dylanpieper.github.io/episodes/articles/survival.html","id":"interpreting-time-varying-results","dir":"Articles","previous_headings":"Time to Discontinuation Analysis > Time-Varying Covariates Model","what":"Interpreting Time-Varying Results","title":"Survival Analysis with episodes and tidymodels","text":"include time-varying covariates, gain additional insights: Mental health disorder continues show strong protective effect (HR = 0.678, 95% CI: 0.647-0.711), consistent fixed-effects model. Housing status emerges significant predictor (housing.L, HR = 1.62, 95% CI: 1.53-1.72), suggesting clients unstable housing 62% higher risk discontinuation. Mortality risk shows slightly attenuated effect (HR = 1.21 vs. 1.40 fixed model), suggesting association explained time-varying factors. Substance type: Opiate use remains associated higher discontinuation risk (HR = 1.17, 95% CI: 1.07-1.27). Frequency use shows clear linear relationship retention. time-varying model provides nuanced understanding retention dynamics, highlighting importance housing stability key factor treatment continuation.","code":""},{"path":[]},{"path":"https://dylanpieper.github.io/episodes/articles/survival.html","id":"last-episode-analysis","dir":"Articles","previous_headings":"Time to Death (Last Episode)","what":"Last Episode Analysis","title":"Survival Analysis with episodes and tidymodels","text":"can also analyze time death, focusing last episode client:","code":"episodes_fixed_death <- substance_use |>   group_by(client_id) |>   segment_episodes(     date_col = visit_date,     gap_threshold = 60,     gap_unit = \"days\",     episodes = \"last\",     progress = FALSE   )  death_model_result <- workflow() |>   add_formula(     Surv(episode_days, died_ever) ~       age + gender + race + substance + medication + mental_health_disorder   ) |>   add_model(surv_spec) |>   fit(data = episodes_fixed_death) |>   extract_fit_parsnip() |>   tidy(exponentiate = TRUE, conf.int = TRUE, conf.level = 0.95)  death_model_result #> # A tibble: 15 × 7 #>    term                estimate std.error statistic   p.value conf.low conf.high #>    <chr>                  <dbl>     <dbl>     <dbl>     <dbl>    <dbl>     <dbl> #>  1 age                    1.00    0.00204     1.56   1.20e- 1    0.999     1.01  #>  2 mental_health_diso…    0.405   0.0560    -16.1    1.55e-58    0.363     0.452 #>  3 mental_health_diso…   NA       0          NA     NA          NA        NA     #>  4 genderFemale           0.948   0.0563     -0.951  3.42e- 1    0.849     1.06  #>  5 genderNon-binary       1.06    0.143       0.389  6.98e- 1    0.799     1.40  #>  6 raceBlack              1.10    0.0784      1.16   2.47e- 1    0.939     1.28  #>  7 raceHispanic           1.05    0.0778      0.633  5.26e- 1    0.902     1.22  #>  8 raceAsian              0.911   0.130      -0.719  4.72e- 1    0.705     1.18  #>  9 raceOther              1.33    0.123       2.34   1.95e- 2    1.05      1.70  #> 10 substanceOpiates       1.29    0.0918      2.76   5.70e- 3    1.08      1.54  #> 11 medicationDisulfir…    0.900   0.109      -0.968  3.33e- 1    0.726     1.11  #> 12 medicationAcampros…    0.853   0.100      -1.59   1.12e- 1    0.700     1.04  #> 13 medicationNaltrexo…    0.859   0.0890     -1.70   8.87e- 2    0.722     1.02  #> 14 medicationMethadone    0.979   0.120      -0.174  8.62e- 1    0.773     1.24  #> 15 medicationBuprenor…    0.904   0.116      -0.869  3.85e- 1    0.721     1.13"},{"path":"https://dylanpieper.github.io/episodes/articles/survival.html","id":"interpreting-mortality-results","dir":"Articles","previous_headings":"Time to Death (Last Episode) > Last Episode Analysis","what":"Interpreting Mortality Results","title":"Survival Analysis with episodes and tidymodels","text":"mortality analysis reveals significant protective risk factors: Mental health disorder: Strong protective association mortality (HR = 0.405, 95% CI: 0.363-0.452), suggesting 59.5% reduction mortality risk clients mental health disorders. Substance type: Opiate users 29% higher mortality risk compared alcohol users (HR = 1.29, 95% CI: 1.08-1.54). Race: “” race category shows elevated mortality risk (HR = 1.33, 95% CI: 1.05-1.70). Medications: reaching statistical significance p<0.05, ’s trend toward protective effects several medications, particularly Acamprosate (HR = 0.853) Naltrexone (HR = 0.859). findings highlight complex relationship mental health comorbidity substance use outcomes, mental health disorders associated better retention lower mortality.","code":""},{"path":"https://dylanpieper.github.io/episodes/articles/survival.html","id":"visualizing-survival-by-substance-type","dir":"Articles","previous_headings":"Time to Death (Last Episode)","what":"Visualizing Survival by Substance Type","title":"Survival Analysis with episodes and tidymodels","text":"survival curves substance type show opiate users (red line) consistently worse survival outcomes compared alcohol users (blue line). separation curves begins early widens time, approximately 85% alcohol users surviving 1000 days compared 75% opiate users. risk table shows number risk decreases time groups.","code":"surv_curves_substance <- survfit(   Surv(episode_days, died_ever) ~ substance,   data = episodes_fixed_death )  ggsurvfit(surv_curves_substance) +   add_confidence_interval() +   add_risktable() +   scale_y_continuous(labels = scales::percent) +   labs(     x = \"Days\",     y = \"Probability of Survival\",     title = \"Kaplan-Meier Curves by Substance\"   )"},{"path":"https://dylanpieper.github.io/episodes/articles/survival.html","id":"time-varying-death-analysis","dir":"Articles","previous_headings":"Time to Death (Last Episode)","what":"Time-Varying Death Analysis","title":"Survival Analysis with episodes and tidymodels","text":"nuanced analysis, can incorporate time-varying covariates:","code":"episodes_tv_death <- substance_use |>   group_by(client_id) |>   segment_episodes_by_covars(     date_col = visit_date,     covar_cols = c(       \"died_last_visit\", \"frequency_of_use\", \"housing\"     ),     gap_threshold = 60,     gap_unit = \"days\",     progress = FALSE   ) |>   group_by(client_id, episode_id) |>   add_surv_time()  death_tv_model <- workflow() |>   add_formula(     Surv(time = start_time, time2 = end_time, event = died_last_visit) ~       age + gender + race + substance + medication + mental_health_disorder +       frequency_of_use + housing + cluster(client_id)   ) |>   add_model(surv_spec) |>   fit(data = episodes_tv_death) |>   extract_fit_parsnip() |>   tidy(exponentiate = TRUE, conf.int = TRUE, conf.level = 0.95)  death_tv_model #> # A tibble: 23 × 7 #>    term                estimate std.error statistic   p.value conf.low conf.high #>    <chr>                  <dbl>     <dbl>     <dbl>     <dbl>    <dbl>     <dbl> #>  1 age                    1.00  0.00204      2.06    3.94e- 2    1.00      1.01  #>  2 mental_health_diso…    0.505 0.0565     -12.1     1.45e-33    0.452     0.565 #>  3 mental_health_diso…   NA     0           NA      NA          NA        NA     #>  4 `cluster(client_id…    1.00  0.0000192   -0.329   7.42e- 1    1.00      1.00  #>  5 genderFemale           0.953 0.0564      -0.855   3.93e- 1    0.853     1.06  #>  6 genderNon-binary       0.987 0.143       -0.0903  9.28e- 1    0.745     1.31  #>  7 raceBlack              1.08  0.0784       1.01    3.15e- 1    0.928     1.26  #>  8 raceHispanic           1.13  0.0781       1.58    1.14e- 1    0.971     1.32  #>  9 raceAsian              0.943 0.130       -0.452   6.51e- 1    0.730     1.22  #> 10 raceOther              1.25  0.124        1.80    7.25e- 2    0.980     1.59  #> # ℹ 13 more rows"},{"path":"https://dylanpieper.github.io/episodes/articles/survival.html","id":"interpreting-time-varying-mortality-results","dir":"Articles","previous_headings":"Time to Death (Last Episode) > Time-Varying Death Analysis","what":"Interpreting Time-Varying Mortality Results","title":"Survival Analysis with episodes and tidymodels","text":"time-varying mortality model reveals additional important factors: Housing status emerges strongest predictor (housing.L, HR = 3.25, 95% CI: 2.91-3.62), indicating unstable housing associated three times risk mortality. Substance type: Opiate use shows even stronger association mortality (HR = 2.11, 95% CI: 1.76-2.53) fixed model. Mental health disorder remains strongly protective (HR = 0.505, 95% CI: 0.452-0.565). Frequency use shows complex non-linear relationship mortality (linear quadratic terms significant). Naltrexone emerges significantly protective (HR = 0.812, 95% CI: 0.681-0.968), suggesting 18.8% reduction mortality risk. Age becomes marginally significant (HR = 1.00, p = 0.039), suggesting small increase mortality risk age. time-varying model highlights critical social determinants health (housing) current use patterns predicting mortality risk beyond static client characteristics.","code":""},{"path":[]},{"path":"https://dylanpieper.github.io/episodes/articles/survival.html","id":"basic-model-with-clustering","dir":"Articles","previous_headings":"Time to Death (All Episodes)","what":"Basic Model with Clustering","title":"Survival Analysis with episodes and tidymodels","text":"analyzing data across episodes client, use clustering account within-client correlation:","code":"episodes_clustered <- substance_use |>   group_by(client_id) |>   segment_episodes_by_covars(     date_col = visit_date,     covar_cols = c(\"died_last_visit\"),     gap_threshold = 60,     gap_unit = \"days\",     progress = FALSE   ) |>   group_by(client_id, episode_id) |>   add_surv_time()  clustered_model <- workflow() |>   add_formula(     Surv(time = start_time, time2 = end_time, event = died_last_visit) ~       age + gender + race + substance + medication + mental_health_disorder +       cluster(client_id)   ) |>   add_model(surv_spec) |>   fit(data = episodes_clustered) |>   extract_fit_parsnip() |>   tidy(exponentiate = TRUE, conf.int = TRUE, conf.level = 0.95)  clustered_model #> # A tibble: 16 × 7 #>    term                estimate std.error statistic   p.value conf.low conf.high #>    <chr>                  <dbl>     <dbl>     <dbl>     <dbl>    <dbl>     <dbl> #>  1 age                    1.00  0.00202     1.49     1.36e- 1    0.999     1.01  #>  2 mental_health_diso…    0.471 0.0566    -13.3      1.75e-40    0.421     0.526 #>  3 mental_health_diso…   NA     0          NA       NA          NA        NA     #>  4 `cluster(client_id…    1.00  0.0000192   0.00688  9.95e- 1    1.00      1.00  #>  5 genderFemale           0.958 0.0563     -0.763    4.45e- 1    0.858     1.07  #>  6 genderNon-binary       1.06  0.143       0.428    6.69e- 1    0.803     1.41  #>  7 raceBlack              1.10  0.0784      1.24     2.16e- 1    0.945     1.28  #>  8 raceHispanic           1.08  0.0779      1.01     3.12e- 1    0.929     1.26  #>  9 raceAsian              0.942 0.130      -0.455    6.49e- 1    0.730     1.22  #> 10 raceOther              1.33  0.123       2.31     2.08e- 2    1.04      1.69  #> 11 substanceOpiates       2.21  0.0920      8.60     7.88e-18    1.84      2.64  #> 12 medicationDisulfir…    0.851 0.109      -1.48     1.39e- 1    0.687     1.05  #> 13 medicationAcampros…    0.811 0.100      -2.08     3.76e- 2    0.666     0.988 #> 14 medicationNaltrexo…    0.823 0.0891     -2.18     2.89e- 2    0.691     0.980 #> 15 medicationMethadone    0.917 0.120      -0.721    4.71e- 1    0.724     1.16  #> 16 medicationBuprenor…    0.867 0.115      -1.23     2.17e- 1    0.692     1.09"},{"path":"https://dylanpieper.github.io/episodes/articles/survival.html","id":"interpreting-clustered-results","dir":"Articles","previous_headings":"Time to Death (All Episodes) > Basic Model with Clustering","what":"Interpreting Clustered Results","title":"Survival Analysis with episodes and tidymodels","text":"analyzing mortality across episodes clustering: Mental health disorder maintains protective association (HR = 0.471, 95% CI: 0.421-0.526). Substance type: Opiate use shows strong association mortality (HR = 2.21, 95% CI: 1.84-2.64). Medications: Acamprosate (HR = 0.811, 95% CI: 0.666-0.988) Naltrexone (HR = 0.823, 95% CI: 0.691-0.980) show statistically significant protective effects. Race: “” race category continues show elevated risk (HR = 1.33, 95% CI: 1.04-1.69). accounting within-client correlation using cluster() function, ensure standard errors appropriately adjusted repeated observations clients.","code":""},{"path":"https://dylanpieper.github.io/episodes/articles/survival.html","id":"comprehensive-model","dir":"Articles","previous_headings":"Time to Death (All Episodes)","what":"Comprehensive Model","title":"Survival Analysis with episodes and tidymodels","text":"Finally, build comprehensive model available time-varying covariates:","code":"episodes_comprehensive <- substance_use |>   group_by(client_id) |>   segment_episodes_by_covars(     date_col = visit_date,     covar_cols = c(       \"died_last_visit\", \"discontinued\", \"frequency_of_use\", \"housing\"     ),     gap_threshold = 60,     gap_unit = \"days\",     progress = FALSE   ) |>   group_by(client_id, episode_id) |>   add_surv_time()  comprehensive_model <- workflow() |>   add_formula(     Surv(time = start_time, time2 = end_time, event = died_last_visit) ~       age + gender + race + substance + medication + mental_health_disorder +       frequency_of_use + housing + discontinued + cluster(client_id)   ) |>   add_model(surv_spec) |>   fit(data = episodes_comprehensive) |>   extract_fit_parsnip() |>   tidy(exponentiate = TRUE, conf.int = TRUE, conf.level = 0.95)  comprehensive_model #> # A tibble: 24 × 7 #>    term                estimate std.error statistic   p.value conf.low conf.high #>    <chr>                  <dbl>     <dbl>     <dbl>     <dbl>    <dbl>     <dbl> #>  1 age                    1.00  0.00204       1.70   8.92e- 2    0.999     1.01  #>  2 mental_health_diso…    0.573 0.0570       -9.77   1.56e-22    0.513     0.641 #>  3 mental_health_diso…   NA     0            NA     NA          NA        NA     #>  4 discontinuedTRUE       2.98  0.0582       18.8    1.71e-78    2.66      3.34  #>  5 `cluster(client_id…    1.00  0.0000193    -1.06   2.91e- 1    1.00      1.00  #>  6 genderFemale           0.932 0.0564       -1.26   2.09e- 1    0.834     1.04  #>  7 genderNon-binary       0.971 0.143        -0.203  8.39e- 1    0.733     1.29  #>  8 raceBlack              1.04  0.0785        0.534  5.93e- 1    0.894     1.22  #>  9 raceHispanic           1.12  0.0780        1.49   1.37e- 1    0.964     1.31  #> 10 raceAsian              0.953 0.130        -0.367  7.14e- 1    0.738     1.23  #> # ℹ 14 more rows"},{"path":"https://dylanpieper.github.io/episodes/articles/survival.html","id":"interpreting-the-comprehensive-model","dir":"Articles","previous_headings":"Time to Death (All Episodes) > Comprehensive Model","what":"Interpreting the Comprehensive Model","title":"Survival Analysis with episodes and tidymodels","text":"fully specified model reveals complete picture mortality risk factors: Treatment discontinuation major risk factor (HR = 2.98, 95% CI: 2.66-3.34), clients discontinue treatment nearly three times mortality risk. Housing instability remains strong predictor (housing.L, HR = 2.77, 95% CI: 2.48-3.09), even controlling factors. Substance type: Opiate use continues show elevated risk (HR = 2.22, 95% CI: 1.85-2.66). Mental health disorder maintains protective association (HR = 0.573, 95% CI: 0.513-0.641), though effect size somewhat attenuated full model. Frequency use shows linear (HR = 1.18, 95% CI: 1.02-1.37) quadratic (HR = 1.34, 95% CI: 1.16-1.55) relationships mortality. Naltrexone continues show protective effect (HR = 0.822, 95% CI: 0.690-0.980). comprehensive model highlights critical interplay treatment retention, social determinants (housing), substance type, medication determining mortality outcomes. finding treatment discontinuation associated nearly three times mortality risk underscores life-saving potential effective retention strategies.","code":""},{"path":"https://dylanpieper.github.io/episodes/articles/survival.html","id":"limitations","dir":"Articles","previous_headings":"","what":"Limitations","title":"Survival Analysis with episodes and tidymodels","text":"Keep mind simple Cox models inspire users {episodes} see easy get started running survival analyses. Additionally, testing assumptions, mainly proportional hazards assumption. limitations consider: proportional hazards assumption verified using tests like Schoenfeld residuals (cox.zph() {survival} package) Recurrent events treated independently, ignoring temporal ordering effects Competing risks multiple states (discontinuation death) accounted , may lead biased estimates","code":""},{"path":"https://dylanpieper.github.io/episodes/articles/survival.html","id":"r-package-suggestions","dir":"Articles","previous_headings":"","what":"R Package Suggestions","title":"Survival Analysis with episodes and tidymodels","text":"’re interested exploring complex modeling approaches, consider:","code":""},{"path":"https://dylanpieper.github.io/episodes/articles/survival.html","id":"for-cox-models","dir":"Articles","previous_headings":"R Package Suggestions","what":"For Cox Models","title":"Survival Analysis with episodes and tidymodels","text":"{survival}: foundation survival analysis R functions Cox regression, Kaplan-Meier curves, diagnostics {survminer}: Enhanced visualization survival analyses {coxme}: Mixed-effects Cox models clustered/grouped data","code":""},{"path":"https://dylanpieper.github.io/episodes/articles/survival.html","id":"more-complex-models","dir":"Articles","previous_headings":"R Package Suggestions","what":"More Complex Models","title":"Survival Analysis with episodes and tidymodels","text":"{cmprsk} {riskRegression}: Competing risks analysis {frailtypack}: Joint frailty models recurrent events terminal events {msm}: Multi-state models transitions states {mstate}: Multi-state modeling Cox proportional hazards model","code":""},{"path":"https://dylanpieper.github.io/episodes/articles/survival.html","id":"assumptions-testing","dir":"Articles","previous_headings":"R Package Suggestions","what":"Assumptions Testing","title":"Survival Analysis with episodes and tidymodels","text":"{flexsurv}: Flexible parametric survival models {timereg}: non-proportional hazards models","code":""},{"path":"https://dylanpieper.github.io/episodes/articles/survival.html","id":"bayesian-approaches","dir":"Articles","previous_headings":"R Package Suggestions","what":"Bayesian Approaches","title":"Survival Analysis with episodes and tidymodels","text":"{rstanarm}: Bayesian survival models using Stan {brms}: Flexible Bayesian regression models including survival models","code":""},{"path":"https://dylanpieper.github.io/episodes/articles/survival.html","id":"conclusion","dir":"Articles","previous_headings":"","what":"Conclusion","title":"Survival Analysis with episodes and tidymodels","text":"{episodes} package provides powerful tools analyzing longitudinal health data: segment_episodes() creates episode-level datasets based temporal gaps segment_episodes_by_covars() allows time-varying covariate analysis add_surv_time() prepares data survival analysis functions integrate seamlessly {tidymodels} survival analysis workflows, enabling sophisticated analyses treatment patterns, outcomes, risk factors. segmenting longitudinal data meaningful episodes incorporating time-varying covariates, researchers can gain deeper insights complex dynamics substance use treatment outcomes.","code":""},{"path":"https://dylanpieper.github.io/episodes/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Dylan Pieper. Author, maintainer.","code":""},{"path":"https://dylanpieper.github.io/episodes/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Pieper D (2025). episodes: Time Series Segmentation Longitudinal Data Analysis. R package version 0.1.0, https://dylanpieper.github.io/episodes/, https://github.com/dylanpieper/episodes.","code":"@Manual{,   title = {episodes: Time Series Segmentation for Longitudinal Data Analysis},   author = {Dylan Pieper},   year = {2025},   note = {R package version 0.1.0, https://dylanpieper.github.io/episodes/},   url = {https://github.com/dylanpieper/episodes}, }"},{"path":"https://dylanpieper.github.io/episodes/index.html","id":"episodes-","dir":"","previous_headings":"","what":"Time Series Segmentation for Longitudinal Data Analysis","title":"Time Series Segmentation for Longitudinal Data Analysis","text":"Segment longitudinal data meaningful episodes based temporal gaps variable changes. ’s designed analyzing treatment patterns, patient journeys, time series data interruptions changes covariates significant. tool useful survival analyses time-varying statistical methods requiring structured temporal data. Features: Identify episodes based gaps dates Track variables change within episodes Analyze continuation (.e., retention) across episodes Support grouped data workflows tidyverse style Track progress long-running operations large datasets","code":""},{"path":"https://dylanpieper.github.io/episodes/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Time Series Segmentation for Longitudinal Data Analysis","text":"CRAN: Development version:","code":"install.packages(\"episodes\") # install.packages(\"pak\") pak::pak(\"dylanpieper/episodes\")"},{"path":[]},{"path":"https://dylanpieper.github.io/episodes/index.html","id":"segmenting-client-treatment-episodes","dir":"","previous_headings":"Basic Usage","what":"Segmenting client treatment episodes","title":"Time Series Segmentation for Longitudinal Data Analysis","text":"Additional fixed variables included results, varying variables excluded. Use segment_episodes_by_covars() track changes specific variables.","code":"library(episodes)  episodes <- substance_use |>   group_by(client_id) |>   segment_episodes(     visit_date,     gap_threshold = 2,     gap_unit = \"months\"   )"},{"path":"https://dylanpieper.github.io/episodes/index.html","id":"identifying-active-vs-inactive-episodes","dir":"","previous_headings":"Basic Usage","what":"Identifying active vs. inactive episodes","title":"Time Series Segmentation for Longitudinal Data Analysis","text":"default, segment_episodes() assigns status episodes : Active: Recent episodes (based inactive_threshold) Inactive: Episodes ended inactive threshold Gap: Episodes followed another episode","code":"status_check <- substance_use |>   group_by(client_id) |>   segment_episodes(     visit_date,      gap_threshold = 2,      gap_unit = \"months\",     inactive_threshold = 3,     inactive_unit = \"months\"   ) |>   count(status)"},{"path":"https://dylanpieper.github.io/episodes/index.html","id":"including-covariate-changes","dir":"","previous_headings":"Basic Usage","what":"Including covariate changes","title":"Time Series Segmentation for Longitudinal Data Analysis","text":"Track important variables change within episodes using segment_episodes_by_covars(): additional status ongoing episodes included segmentation episodes changes covariates.","code":"episodes_by_covars <- substance_use |>   group_by(client_id) |>   segment_episodes_by_covars(     visit_date,     covar_cols = c(\"substance_use_past_week\",                     \"quality_of_life_score\",                     \"medication_dose_mg\"),     gap_threshold = 2,     gap_unit = \"months\"   ) |>   arrange(client_id, episode_id, segment_id)"},{"path":"https://dylanpieper.github.io/episodes/index.html","id":"analyzing-continuation-ie-retention","dir":"","previous_headings":"Basic Usage","what":"Analyzing continuation (i.e., retention)","title":"Time Series Segmentation for Longitudinal Data Analysis","text":"split_episode() function helps analyze whether episodes continue past specific time thresholds: function adds columns threshold: *_date: date corresponding threshold episode start *_eligible: Whether enough time passed evaluate threshold *_continued: Whether episode continued past threshold","code":"retention <- episodes |>   split_episode(     thresholds = c(30, 12, 6),      units = c(\"days\", \"weeks\", \"months\")   )"},{"path":"https://dylanpieper.github.io/episodes/index.html","id":"dataset","dir":"","previous_headings":"","what":"Dataset","title":"Time Series Segmentation for Longitudinal Data Analysis","text":"package includes simulated substance use treatment dataset: Read use data run survival analyses using vignette(\"survival\", package = \"episodes\").","code":"glimpse(substance_use)"},{"path":"https://dylanpieper.github.io/episodes/reference/add_surv_time.html","id":null,"dir":"Reference","previous_headings":"","what":"Add Segment Start and End Times for Survival Analysis — add_surv_time","title":"Add Segment Start and End Times for Survival Analysis — add_surv_time","text":"Add segment start end times relative minimum start time within group. Handles edge cases end time equals 0 equals start time adding 1 play nice survival analysis estimators.","code":""},{"path":"https://dylanpieper.github.io/episodes/reference/add_surv_time.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Add Segment Start and End Times for Survival Analysis — add_surv_time","text":"","code":"add_surv_time(grouped_df)"},{"path":"https://dylanpieper.github.io/episodes/reference/add_surv_time.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Add Segment Start and End Times for Survival Analysis — add_surv_time","text":"grouped_df grouped dataframe containing segment_start segment_end columns","code":""},{"path":"https://dylanpieper.github.io/episodes/reference/add_surv_time.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Add Segment Start and End Times for Survival Analysis — add_surv_time","text":"grouped dataframe additional start_time end_time columns","code":""},{"path":"https://dylanpieper.github.io/episodes/reference/madd.html","id":null,"dir":"Reference","previous_headings":"","what":"Lubridate operator to add time — %m+%","title":"Lubridate operator to add time — %m+%","text":"See lubridate::%m+% details.","code":""},{"path":"https://dylanpieper.github.io/episodes/reference/madd.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Lubridate operator to add time — %m+%","text":"","code":"lhs %m+% rhs"},{"path":"https://dylanpieper.github.io/episodes/reference/madd.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Lubridate operator to add time — %m+%","text":"lhs date-time object. rhs period duration object.","code":""},{"path":"https://dylanpieper.github.io/episodes/reference/madd.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Lubridate operator to add time — %m+%","text":"result adding rhs lhs.","code":""},{"path":"https://dylanpieper.github.io/episodes/reference/msubtract.html","id":null,"dir":"Reference","previous_headings":"","what":"Lubridate operator to subtract time — %m-%","title":"Lubridate operator to subtract time — %m-%","text":"See lubridate::%m-% details.","code":""},{"path":"https://dylanpieper.github.io/episodes/reference/msubtract.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Lubridate operator to subtract time — %m-%","text":"","code":"lhs %m-% rhs"},{"path":"https://dylanpieper.github.io/episodes/reference/msubtract.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Lubridate operator to subtract time — %m-%","text":"lhs date-time object. rhs period duration object.","code":""},{"path":"https://dylanpieper.github.io/episodes/reference/msubtract.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Lubridate operator to subtract time — %m-%","text":"result subtracting rhs lhs.","code":""},{"path":"https://dylanpieper.github.io/episodes/reference/segment_episodes.html","id":null,"dir":"Reference","previous_headings":"","what":"Segment time series data into episodes based on date gaps — segment_episodes","title":"Segment time series data into episodes based on date gaps — segment_episodes","text":"segment_episodes() identifies episodes temporal data detecting gaps dates exceed specified threshold. episode ends gap consecutive dates larger gap_threshold. Episodes also classified 'active' 'inactive' based recency.","code":""},{"path":"https://dylanpieper.github.io/episodes/reference/segment_episodes.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Segment time series data into episodes based on date gaps — segment_episodes","text":"","code":"segment_episodes(   .data,   date_col,   max_date = NULL,   gap_threshold = Inf,   gap_unit = \"days\",   inactive_threshold = gap_threshold,   inactive_unit = gap_unit,   episodes = \"all\",   progress = TRUE )"},{"path":"https://dylanpieper.github.io/episodes/reference/segment_episodes.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Segment time series data into episodes based on date gaps — segment_episodes","text":".data grouped data frame. Must pre-grouped dplyr::group_by(). date_col Column containing date values analyze. max_date Optional reference date determining active/inactive status. Defaults maximum date dataset. gap_threshold Numeric value specifying gap size defines new episode. Default Inf. gap_unit Units gap threshold. One \"days\", \"weeks\", \"months\". Default \"days\". inactive_threshold Threshold considering episode inactive. Default gap_threshold. inactive_unit Units inactive threshold. One \"days\", \"weeks\", \"months\". Default gap_unit. episodes episodes return. Options \"\", \"first\", \"last\", specific episode number. Default \"\". progress Logical. Display progress bar processing? Default TRUE.","code":""},{"path":"https://dylanpieper.github.io/episodes/reference/segment_episodes.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Segment time series data into episodes based on date gaps — segment_episodes","text":"data frame one row per episode containing: episode_id: Numeric episode identifier episode_start: Date episode started episode_end: Date episode ended episode_days: Duration episode days discontinued: Logical indicating episode discontinued status: Character indicating episode status (\"Active\", \"Inactive\", \"Gap\") dates_count: Number dates episode dates_avg_days_between: Average number days consecutive dates episode dates_sd_days_between: Standard deviation days consecutive dates gap_days: Number days episode next one (NA last episode) variables: fixed variables input data frame","code":""},{"path":[]},{"path":"https://dylanpieper.github.io/episodes/reference/segment_episodes.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Segment time series data into episodes based on date gaps — segment_episodes","text":"","code":"data(substance_use) treatment_episodes <- substance_use |>   group_by(client_id) |>   segment_episodes(     visit_date,     gap_threshold = 2,     gap_unit = \"months\"   ) #> Segmenting episodes ■                                  1% | ETA:  1m #> Segmenting episodes ■■■                                8% | ETA: 45s #> Segmenting episodes ■■■■■■                            15% | ETA: 39s #> Segmenting episodes ■■■■■■■■                          22% | ETA: 34s #> Segmenting episodes ■■■■■■■■■■                        30% | ETA: 31s #> Segmenting episodes ■■■■■■■■■■■■                      37% | ETA: 28s #> Segmenting episodes ■■■■■■■■■■■■■■                    44% | ETA: 24s #> Segmenting episodes ■■■■■■■■■■■■■■■■                  51% | ETA: 21s #> Segmenting episodes ■■■■■■■■■■■■■■■■■■                58% | ETA: 18s #> Segmenting episodes ■■■■■■■■■■■■■■■■■■■■              64% | ETA: 16s #> Segmenting episodes ■■■■■■■■■■■■■■■■■■■■■■            71% | ETA: 13s #> Segmenting episodes ■■■■■■■■■■■■■■■■■■■■■■■■          78% | ETA: 10s #> Segmenting episodes ■■■■■■■■■■■■■■■■■■■■■■■■■■        84% | ETA:  7s #> Segmenting episodes ■■■■■■■■■■■■■■■■■■■■■■■■■■■■      92% | ETA:  4s #> Segmenting episodes ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■   99% | ETA:  1s #> Segmenting episodes ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■  100% | ETA:  0s #> Only fixed variables are included: #> • Included: \"substance\", \"medication\", \"age\", \"gender\", \"race\", #>   \"mental_health_disorder\", and \"died_ever\" #> • Excluded: \"frequency_of_use\", \"housing\", \"discontinued\", and #>   \"died_last_visit\" #> Use `episodes::segment_episodes_by_covars()` to include variables with changing #> values"},{"path":"https://dylanpieper.github.io/episodes/reference/segment_episodes_by_covars.html","id":null,"dir":"Reference","previous_headings":"","what":"Segment time series data into episodes with covariate change tracking — segment_episodes_by_covars","title":"Segment time series data into episodes with covariate change tracking — segment_episodes_by_covars","text":"segment_episodes_by_covars() identifies episodes temporal data detecting gaps dates exceed specified threshold, segments episodes covariate values change. episode ends gap consecutive dates larger gap_threshold. Within episode, segments created whenever covariate values change.","code":""},{"path":"https://dylanpieper.github.io/episodes/reference/segment_episodes_by_covars.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Segment time series data into episodes with covariate change tracking — segment_episodes_by_covars","text":"","code":"segment_episodes_by_covars(   .data,   date_col,   covar_cols,   max_date = NULL,   gap_threshold = Inf,   gap_unit = \"days\",   inactive_threshold = gap_threshold,   inactive_unit = gap_unit,   episodes = \"all\",   progress = TRUE )"},{"path":"https://dylanpieper.github.io/episodes/reference/segment_episodes_by_covars.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Segment time series data into episodes with covariate change tracking — segment_episodes_by_covars","text":".data data frame time series data date_col Column containing date values analyze covar_cols Columns monitor changes trigger segmentation max_date Optional reference date determining active/inactive status Defaults maximum date dataset gap_threshold Numeric value specifying gap size defines new episode Default Inf gap_unit Units gap threshold. One \"days\", \"weeks\", \"months\" Default \"days\" inactive_threshold Threshold considering episode inactive Default gap_threshold inactive_unit Units inactive threshold. One \"days\", \"weeks\", \"months\" Default gap_unit episodes episodes return. Options \"\", \"first\", \"last\", specific episode number. Default \"\" progress Logical. Display progress bar processing? Default TRUE","code":""},{"path":"https://dylanpieper.github.io/episodes/reference/segment_episodes_by_covars.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Segment time series data into episodes with covariate change tracking — segment_episodes_by_covars","text":"data frame one row per segment containing: episode_id: Numeric episode identifier segment_id: String segment identifier (format: \"episode.segment\") episode_start: Date episode started episode_end: Date episode ended segment_start: Date segment started segment_end: Date segment ended episode_days: Duration episode days segment_days: Duration segment days discontinued: Logical indicating segment discontinued status: Character indicating segment status (\"Active\", \"Inactive\", \"Gap\", \"Ongoing\") dates_count: Number dates segment dates_avg_days_between: Average number days consecutive dates segment dates_sd_days_between: Standard deviation days consecutive dates gap_days: Number days segment next one (NA last segment) covariates: Columns specified covar_cols variables: fixed variables input data frame","code":""},{"path":[]},{"path":"https://dylanpieper.github.io/episodes/reference/segment_episodes_by_covars.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Segment time series data into episodes with covariate change tracking — segment_episodes_by_covars","text":"","code":"data(substance_use) treatment_episodes_by_covars <- substance_use |>   group_by(client_id) |>   segment_episodes_by_covars(     visit_date,     covar_cols = c(\"died_last_visit\", \"frequency_of_use\", \"housing\"),     gap_threshold = 2,     gap_unit = \"months\"   ) #> Segmenting episodes by covariates ■■                                 3% | ETA: … #> Segmenting episodes by covariates ■■■                                5% | ETA: … #> Segmenting episodes by covariates ■■■■■                             14% | ETA: … #> Segmenting episodes by covariates ■■■■■■■■                          23% | ETA: … #> Segmenting episodes by covariates ■■■■■■■■■■                        31% | ETA: … #> Segmenting episodes by covariates ■■■■■■■■■■■■■                     40% | ETA: … #> Segmenting episodes by covariates ■■■■■■■■■■■■■■■■                  49% | ETA: … #> Segmenting episodes by covariates ■■■■■■■■■■■■■■■■■■                58% | ETA: … #> Segmenting episodes by covariates ■■■■■■■■■■■■■■■■■■■■■             66% | ETA: … #> Segmenting episodes by covariates ■■■■■■■■■■■■■■■■■■■■■■■■          75% | ETA: … #> Segmenting episodes by covariates ■■■■■■■■■■■■■■■■■■■■■■■■■■        85% | ETA: … #> Segmenting episodes by covariates ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■     94% | ETA: … #> Segmenting episodes by covariates ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■  100% | ETA: … #> Covariates used for segmentation: #> • \"died_last_visit\", \"frequency_of_use\", and \"housing\" #> Fixed variables included: #> • \"substance\", \"medication\", \"age\", \"gender\", \"race\", \"mental_health_disorder\", #>   and \"died_ever\" #> Varying variables excluded: #> • \"discontinued\""},{"path":"https://dylanpieper.github.io/episodes/reference/split_episode.html","id":null,"dir":"Reference","previous_headings":"","what":"Split episodes to analyze continuation across time thresholds — split_episode","title":"Split episodes to analyze continuation across time thresholds — split_episode","text":"split_episode() splits output segment_episodes() analyze whether episodes continue past specific time thresholds.","code":""},{"path":"https://dylanpieper.github.io/episodes/reference/split_episode.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Split episodes to analyze continuation across time thresholds — split_episode","text":"","code":"split_episode(.data, thresholds, units = NULL, max_date = NULL)"},{"path":"https://dylanpieper.github.io/episodes/reference/split_episode.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Split episodes to analyze continuation across time thresholds — split_episode","text":".data data frame output segment_episodes() containing minimum columns episode_start episode_end. thresholds Numeric vector time thresholds analyze. units Character vector time units corresponding threshold, single unit apply thresholds. One \"days\", \"weeks\", \"months\". Defaults \"days\" thresholds NULL. max_date Optional reference date use eligibility calculations. Defaults current system date.","code":""},{"path":"https://dylanpieper.github.io/episodes/reference/split_episode.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Split episodes to analyze continuation across time thresholds — split_episode","text":"input data frame additional columns threshold: threshold_unit_date: date corresponding threshold unit episode_start threshold_unit_eligible: Logical indicating enough time passed evaluate threshold threshold_unit_continued: Logical indicating episode continued past threshold","code":""},{"path":[]},{"path":"https://dylanpieper.github.io/episodes/reference/split_episode.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Split episodes to analyze continuation across time thresholds — split_episode","text":"","code":"data(substance_use) # First, segment the data into episodes treatment_episodes <- substance_use |>   group_by(client_id) |>   segment_episodes(     visit_date,     gap_threshold = 2,     gap_unit = \"months\"   ) #> Segmenting episodes ■                                  1% | ETA:  1m #> Segmenting episodes ■■                                 2% | ETA:  1m #> Segmenting episodes ■■■■                               9% | ETA: 42s #> Segmenting episodes ■■■■■■                            16% | ETA: 38s #> Segmenting episodes ■■■■■■■■                          23% | ETA: 34s #> Segmenting episodes ■■■■■■■■■■                        30% | ETA: 31s #> Segmenting episodes ■■■■■■■■■■■■                      38% | ETA: 27s #> Segmenting episodes ■■■■■■■■■■■■■■■                   46% | ETA: 23s #> Segmenting episodes ■■■■■■■■■■■■■■■■■                 53% | ETA: 20s #> Segmenting episodes ■■■■■■■■■■■■■■■■■■■               60% | ETA: 17s #> Segmenting episodes ■■■■■■■■■■■■■■■■■■■■■             67% | ETA: 14s #> Segmenting episodes ■■■■■■■■■■■■■■■■■■■■■■■■          75% | ETA: 10s #> Segmenting episodes ■■■■■■■■■■■■■■■■■■■■■■■■■■        83% | ETA:  7s #> Segmenting episodes ■■■■■■■■■■■■■■■■■■■■■■■■■■■■      91% | ETA:  4s #> Segmenting episodes ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■    98% | ETA:  1s #> Segmenting episodes ■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■■  100% | ETA:  0s #> Only fixed variables are included: #> • Included: \"substance\", \"medication\", \"age\", \"gender\", \"race\", #>   \"mental_health_disorder\", and \"died_ever\" #> • Excluded: \"frequency_of_use\", \"housing\", \"discontinued\", and #>   \"died_last_visit\" #> Use `episodes::segment_episodes_by_covars()` to include variables with changing #> values  # Then analyze whether episodes continue past specific thresholds episode_retention <- treatment_episodes |>   split_episode(thresholds = c(30, 60, 90, 180), units = \"days\")  # Analyze retention rates at different thresholds retention_summary <- episode_retention |>   summarize(     episodes_count = n(),     continued_30d = sum(days_30_continued, na.rm = TRUE),     continued_60d = sum(days_60_continued, na.rm = TRUE),     continued_90d = sum(days_90_continued, na.rm = TRUE),     continued_180d = sum(days_180_continued, na.rm = TRUE),     pct_30d = mean(days_30_continued, na.rm = TRUE) * 100,     pct_60d = mean(days_60_continued, na.rm = TRUE) * 100,     pct_90d = mean(days_90_continued, na.rm = TRUE) * 100,     pct_180d = mean(days_180_continued, na.rm = TRUE) * 100   )  # You can also use different time units monthly_retention <- treatment_episodes |>   split_episode(     thresholds = c(1, 3, 6, 12),     units = \"months\"   )"},{"path":"https://dylanpieper.github.io/episodes/reference/substance_use.html","id":null,"dir":"Reference","previous_headings":"","what":"Substance Use Treatment Dataset — substance_use","title":"Substance Use Treatment Dataset — substance_use","text":"simulated dataset containing information substance use treatment clients, visits, medication, outcomes, demographics.","code":""},{"path":"https://dylanpieper.github.io/episodes/reference/substance_use.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Substance Use Treatment Dataset — substance_use","text":"","code":"substance_use"},{"path":"https://dylanpieper.github.io/episodes/reference/substance_use.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Substance Use Treatment Dataset — substance_use","text":"tibble 16,823 rows 13 variables: client_id Integer ID client visit_date Date clinical visit substance Factor substance types (e.g., Alcohol, Opiates) medication Factor medication types (e.g., Acamprosate, Naltrexone) frequency_of_use Ordered factor use frequency (Monthly, Several times per week, Daily) age Numeric client age gender Factor client gender race Factor client race housing Ordered factor housing status (Unhoused, Unstable, Stable) mental_health_disorder Logical indicating presence mental health disorder discontinued Logical indicating treatment discontinued died_ever Logical indicating client died point study died_last_visit Logical indicating client died last recorded visit","code":""},{"path":"https://dylanpieper.github.io/episodes/reference/substance_use.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Substance Use Treatment Dataset — substance_use","text":"Simulated data created reflect realistic patterns observed substance use treatment programs.","code":""},{"path":"https://dylanpieper.github.io/episodes/reference/substance_use.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Substance Use Treatment Dataset — substance_use","text":"","code":"summary(substance_use) #>    client_id      visit_date           substance     #>  Min.   :   1   Min.   :2020-01-01   Alcohol:12611   #>  1st Qu.:1199   1st Qu.:2020-01-01   Opiates: 4212   #>  Median :2475   Median :2020-03-31                   #>  Mean   :2466   Mean   :2020-09-05                   #>  3rd Qu.:3707   3rd Qu.:2021-01-25                   #>  Max.   :5000   Max.   :2024-12-05                   #>                   medication                 frequency_of_use      age        #>  None                  :2571   Occasional            :1716    Min.   :18.00   #>  Disulfiram            :2788   Monthly               :1904    1st Qu.:30.00   #>  Acamprosate           :4083   Weekly                :2871    Median :41.00   #>  Naltrexone            :4502   Several times per week:4931    Mean   :41.32   #>  Methadone             :1205   Daily                 :5401    3rd Qu.:53.00   #>  Buprenorphine-Naloxone:1674                                  Max.   :65.00   #>         gender           race            housing      mental_health_disorder #>  Male      :7989   White   :10025   Stable   :12926   Mode :logical          #>  Female    :8173   Black   : 2619   Temporary: 2028   FALSE:11153            #>  Non-binary: 661   Hispanic: 2557   Unstable :  997   TRUE :5670             #>                    Asian   :  866   Unhoused :  872                          #>                    Other   :  756                                            #>                                                                              #>  discontinued    died_ever       died_last_visit #>  Mode :logical   Mode :logical   Mode :logical   #>  FALSE:13203     FALSE:13621     FALSE:15504     #>  TRUE :3620      TRUE :3202      TRUE :1319      #>                                                  #>                                                  #>"},{"path":"https://dylanpieper.github.io/episodes/news/index.html","id":"episodes-010","dir":"Changelog","previous_headings":"","what":"episodes 0.1.0","title":"episodes 0.1.0","text":"Initial CRAN submission segment_episodes() identify episodes based temporal gaps segment_episodes_by_covars() track variable changes within episodes split_episode() analyze retention across time thresholds Includes sample dataset substance_use demonstration Includes vignette use package survival analyses using ‘tidymodels’ (vignette(\"survival\", package = \"episodes\")) Designed analyzing treatment patterns, patient journeys, longitudinal data","code":""}]
